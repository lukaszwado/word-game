"use strict";angular.module("avriosApp",["ngRoute"]).constant("DEFAULT_LEVEL",5).constant("GAME_TIME",4e4).constant("API_PATH","//api.wordnik.com/v4/words.json/randomWords?hasDictionaryDef=true&excludePartOfSpeech=family-name,given-name&minCorpusCount=100000&maxCorpusCount=-1&minDictionaryCount=2&maxDictionaryCount=-1&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5"),function(){function e(e){const t={};return t.level=e,{get:function(e){return t[e]},set:function(e,n){return t[e]=n,n},add:function(e,n){return t[e]+=n,t[e]}}}angular.module("avriosApp").factory("stateService",[e]),e.$inject=["DEFAULT_LEVEL"]}(),function(){function e(e,t){return e.set("level",t),{bump:function(){let t=e.get("level");return e.set("level",++t)},get:function(){return e.get("level")}}}angular.module("avriosApp").factory("gameLevelService",e),e.$inject=["stateService","DEFAULT_LEVEL"]}(),function(){function e(){const e={state:{},get:function(t){return t?e.state[t]:e.state},set:function(t,n){return e.state[t]=n,n}};return e}angular.module("avriosApp").factory("gameStateService",e),e.$inject=[]}(),function(){function e(e,t,n){function r(){n.get("words").shift()}function o(){t().then(e=>n.get("words").push(...e))}function i(e,t){let n=0;for(let r=0;r<e.length;r++){const o=e[r]===t;o&&n++}return n}const a={findLetter:function(e){const t=a.getCurrentWord(),r=n.get("selectedLetters"),o=t.random;for(let t=0;t<o.length;t++){const n=o[t],i=n.letter===e,a=!r.includes(n.index);if(i&&a)return n}},checkIfLetterAvailable:function(e){const t=n.get("answer"),r=i(a.getCurrentWord("word"),e),o=i(t,e);return r>0&&r>o},checkStatus:function(e,t){const n=a.getCurrentWord("word");return{setWordAsSolved:e.toLowerCase()===n,letterDeleted:e.length<t.length}},decreaseWordScore:function(){const e=a.getCurrentWord();return e.score>0&&e.score--,e.score},removeFromSelected:function(){const e=n.get("cursorPosition"),t=n.get("removeMethod"),r=n.get("selectedLetters"),o="backspace"===t?-1:0;r.splice(e+o,1)},setWordAsSolved:function(){const t=a.getCurrentWord("score"),i=n.get("words");e.set("score",t),n.set("newWord",!0),n.set("answer",""),n.get("selectedLetters").length=0,r(),i.length<2&&o()},updateStatus:function(e,t){const n=a.checkStatus(e,t);n.setWordAsSolved?a.setWordAsSolved():n.letterDeleted&&(a.removeFromSelected(),a.decreaseWordScore())},getCurrentWord:function(e){const t=n.get("words")[0];return e?t[e]:t}};return a}angular.module("avriosApp").factory("gameWordService",e),e.$inject=["stateService","gameDataService","gameStateService"]}(),function(){function e(e,t,n){function r(e){const t=e;return t.word=t.word.toLowerCase(),t}function o(e){const t=e;return t.array=t.word.split(""),t}function i(e){const t=e;return t.array=t.array.map((e,t)=>({letter:e,index:t})),t}function a(e){const t=e,n=t.word.length;return t.score=Math.floor(Math.pow(1.95,n/3)),t}function s(e){const t=e;return t.random=c(t.array,t.word),t}function c(e,t){let n=0;const r=Array.from(e);return r.sort(function(){const e=1===n?.3:.7,t=l(n?e:.5);return n=t,t}),u(r,t)?r:c(r,t)}function l(e=.5){let t=e-Math.random();return 0===t&&(t=l()),t>0?1:-1}function u(e,t){return t!==e.join("")}function d(e,t){const n=e.word.length,r=t.word.length;return n<r?-1:n>r?1:0}return function(){const c=n.get(),l=e.get(`${t}&minLength=${c}&maxLength=${c}&limit=2`);return n.bump(),l.then(e=>e.data).then(e=>{if(e.length)return e;throw new Error("You guessed all words!")}).then(e=>[].concat(...e)).then(e=>e.map(a)).then(e=>e.sort(d)).then(e=>e.map(r)).then(e=>e.map(o)).then(e=>e.map(i)).then(e=>e.map(s)).catch(e=>{throw console.error(e),e})}}angular.module("avriosApp").factory("gameDataService",e),e.$inject=["$http","API_PATH","gameLevelService"]}(),function(){function e(e,t,n,r,o){function i(e){const t=r.get("answer");r.set("answer",t+e.toLowerCase())}const a=this;t.set("score",0),r.set("answer",""),r.set("words",o),r.set("newWord",!0),r.set("selectedLetters",[]),r.set("addLetterToAnswer",i),a.globalState=t.get,a.localState=r.get(),a.getWord=n.getCurrentWord,a.markAsUsed=function(e){"number"==typeof e&&r.get("selectedLetters").push(e)},a.findLetterByKeyCode=function(e){const t=String.fromCharCode(e).toLowerCase();return n.findLetter(t)},a.letterInUse=function(e){return r.get("selectedLetters").includes(e)},a.addLetterToAnswer=i,a.deleteLastLetter=function(){const e=r.get("answer"),t=e.slice(0,-1);r.set("cursorPosition",t.length),r.set("answer",e.slice(0,-1))},a.isLetterValid=function(e){return r.get("selectedLetters").indexOf(e)===e},e.$watch(()=>r.get("answer"),function(e,t){r.get("newWord")?r.set("newWord",!1):n.updateStatus(e,t)}),e.$on("avrios.time.end",function(){console.log("this is the end...")})}angular.module("avriosApp").controller("gameCtrl",e),e.$inject=["$scope","stateService","gameWordService","gameStateService","gameData"]}(),function(){function e(){}angular.module("avriosApp").controller("missionCtrl",e),e.$inject=[]}(),function(){function e(e,t){function n(){null!==a.endTime||(a.endTime=Date.now()+t);const e=a.endTime-Date.now();e<=0?r():o(e)}function r(){a.time="0.00",clearInterval(a.timerInterval),a.timerInterval=null,e.$emit("avrios.time.end"),e.$digest()}function o(t){a.time=i(t),requestAnimationFrame(()=>{e.$digest()})}function i(e){return(e/1e3).toFixed(2)}const a=this;a.time=i(t),a.endTime=null,a.start=(()=>{a.timerInterval=setInterval(n,32)}),e.$on("$destroy",()=>{clearInterval(a.timerInterval)})}angular.module("avriosApp").controller("timerCtrl",e),e.$inject=["$scope","GAME_TIME"]}(),function(){angular.module("avriosApp").directive("avriosTimer",function(){return{restrict:"A",controller:"timerCtrl as timer",scope:!0,link:{post:function(e){e.timer.start()}}}})}(),function(){function e(e,t){return{restrict:"A",link:function(n,r){function o(e){!!e.originalEvent.clipboardData&&e.preventDefault()}function i(e){const n=String.fromCharCode(e.which).toLowerCase();t.checkIfLetterAvailable(n)||e.preventDefault()}function a({which:t}){const n=8===t;46===t?e.set("removeMethod","delete"):n&&e.set("removeMethod","backspace")}function s(){e.set("cursorPosition",r[0].selectionStart)}function c(t){const r=window.innerWidth<640,o=!!t;e.set("isMobile",r),o&&n.$parent.$apply()}r.on("paste input propertychange",o),r.on("keydown",s),r.on("keydown",a),r.on("keypress",i),window.addEventListener("resize",c),c(!1),r.focus(),n.$on("$destroy",function(){r.off("paste input propertychange",o),r.off("keydown",s),r.off("keydown",a),r.off("keydown",i),window.removeEventListener("resize",c)})}}}angular.module("avriosApp").directive("avriosGameInput",e),e.$inject=["gameStateService","gameWordService"]}(),function(){function e(e){return function(n){for(const r in n)if("default"!==r){const o=t(n[r]);e.when(r,o)}e.otherwise({redirectTo:n.default})}}function t(e){const t={},n=e.module;return t.controller=`${n}Ctrl`,t.controllerAs=n,t.templateUrl=`components/${n}/${n}.view.html`,t.resolve=e.resolve,t}angular.module("avriosApp").provider("simpleRoute",["$routeProvider",function(t){this.$get=[],this.init=e(t)}])}(),function(){function e(e){function t(e){return e()}const n={default:"/mission","/game":{module:"game",resolve:{gameData:t}},"/mission":{module:"mission"}};e.init(n),t.$inject=["gameDataService"]}angular.module("avriosApp").config(e),e.$inject=["simpleRouteProvider"]}(),angular.module("avriosApp").run(["$templateCache",function(e){e.put("components/game/game.view.html",'<header class="bs-docs-nav navbar"> <div class="container"> <div class="avrios-layout__flex avrios-layout__flex--h-space-between"> <div class="avrios-game__score"> <div class="avrios-game__text--active"> Time: </div> <div class="avrios-game__text--large"> <div class="avrios-timer" avrios-timer>{{timer.time}}</div> </div> </div> <div class="avrios-game__score"> <div class="avrios-game__text--active"> Score: </div> <div class="avrios-game__text--large"> {{game.globalState(\'score\')}} </div> </div> </div> </div> </header> <div class="container"> <div class="avrios-layout__flex avrios-layout__flex--h-center"> <div> <div class="avrios-game__block"> <div>Your letters:</div> <div class="avrios-game__words-container avrios-layout__flex avrios-layout__flex--wrap"> <div class="avrios-game__words-letter" ng-class="{\n                            \'avrios-game__words-letter--valid\': game.isLetterValid(letterObj.index),\n                            \'avrios-game__words-letter--invalid\': game.letterInUse(letterObj.index) && !game.isLetterValid(letterObj.index)\n                            }" ng-repeat="letterObj in game.getWord(\'random\') track by $index" ng-click="!game.letterInUse(letterObj.index) && game.addLetterToAnswer(letterObj.letter) || game.markAsUsed(letterObj.index)"> {{letterObj.letter}} </div> </div> </div> <div class="avrios-game__block"> <div class="form-group"> <label for="answer">Enter your answer:</label> <div class="input-group"> <span class="form-control avrios-game__input" ng-show="game.localState.isMobile"> {{game.localState.answer}} </span> <input class="form-control avrios-game__input" ng-show="!game.localState.isMobile" id="answer" name="answer" avrios-game-input ng-model="game.localState.answer" ng-keydown="game.markAsUsed(game.findLetterByKeyCode($event.which).index)"> <div class="input-group-addon avrios-game__input-addon" ng-click="game.deleteLastLetter()"> <span class="glyphicon glyphicon-erase"></span> </div> </div> </div> </div> <div class="avrios-game__block"> Word Score: <span class="avrios-game__text--active">{{game.getWord(\'score\')}}</span> </div> </div> </div> </div>'),e.put("components/mission/mission.view.html","mission")}]);